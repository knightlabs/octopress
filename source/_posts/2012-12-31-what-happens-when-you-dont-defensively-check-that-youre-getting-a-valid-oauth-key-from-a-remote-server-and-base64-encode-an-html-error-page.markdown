---
layout: post
title: "What happens when you don't defensively check that you're getting a valid OAuth key from a remote server and base64-encode an HTML error page"
date: 2012-12-31 11:59
comments: true
categories: 
---
The correct encoding should be 128 bytes. Decoding the entire page is left as an exercise to the reader. Update: Matt has posted a solution, and a much better writeup: https://silicon.pd.local/display/~mjohnson/2012/12/28/Social+Learn+-+Bad+OAuth+Keys+for+Sites+Stored+in+Redis

*The text below should have newlines removed to decode; added simply for readability. The unbroken string is attached as a file to the post.*

    rO0ABXQK9DwhRE9DVFlQRSBodG1sIFBVQkxJQyAiLS8vVzNDLy9EVEQgWEhUTUwgMS4wIFRyYW5zaXR
    pb25hbC8vRU4iICJodHRwOi8vd3d3LnczLm9yZy9UUi94aHRtbDEvRFREL3hodG1sMS10cmFuc2l0aW
    9uYWwuZHRkIj4NCjxodG1sIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hodG1sIj4NCjxoZ
    WFkPg0KPE1FVEEgTkFNRT0ia2V5d29yZHMiIENPTlRFTlQ9ImJibWgtYm94ZG93biI+DQo8TUVUQSBI
    VFRQLUVRVUlWPSJDQUNIRS1DT05UUk9MIiBDT05URU5UPSJOTy1DQUNIRSI+DQo8bWV0YSBodHRwLWV
    xdWl2PSJjb250ZW50LXR5cGUiIGNvbnRlbnQ9InRleHQvaHRtbDsgY2hhcnNldD1JU08tODg1OS0xIj
    4NCjxtZXRhIGh0dHAtZXF1aXY9IlByYWdtYSIgY29udGVudD0ibm8tY2FjaGUiPg0KPG1ldGEgaHR0c
    C1lcXVpdj0iRXhwaXJlcyIgY29udGVudD0iLTEiPg0KPG1ldGEgaHR0cC1lcXVpdj0iY2FjaGUtY29u
    dHJvbCIgY29udGVudD0ibm8tc3RvcmUiPiANCg0KPHRpdGxlPkJsYWNrYm9hcmQgVGVtcG9yYXJpbHk
    gVW5hdmFpbGFibGU8L3RpdGxlPg0KPHN0eWxlPg0KZGl2IHsNCglmb250LWZhbWlseTp0YWhvbWEsYX
    JpYWwsdmVyZGFuYTsNCglmb250LXNpemU6MTZweCA7DQp9DQphOmxpbmsgew0KZm9udC1mYW1pbHk6d
    GFob21hLGFyaWFsLHZlcmRhbmE7DQogIGNvbG9yOiBibHVlIDsNCiAgYmFja2dyb3VuZC1jb2xvcjog
    dHJhbnNwYXJlbnQgOw0KICB0ZXh0LWRlY29yYXRpb246IG5vbmUgOw0KZm9udC1zaXplOjEzcHg7DQp
    9DQphOmhvdmVyIHsNCiAgY29sb3I6IHJlZCA7DQpmb250LWZhbWlseTp0YWhvbWEsYXJpYWwsdmVyZG
    FuYTsNCiAgIGJhY2tncm91bmQtY29sb3I6IHRyYW5zcGFyZW50IDsNCmZvbnQtc2l6ZToxM3B4Ow0Kf
    Q0KDQphOnZpc2l0ZWQgew0KICBjb2xvcjogcmVkIDsNCmZvbnQtZmFtaWx5OnRhaG9tYSxhcmlhbCx2
    ZXJkYW5hOw0KICAgYmFja2dyb3VuZC1jb2xvcjogdHJhbnNwYXJlbnQgOw0KZm9udC1zaXplOjEzcHg
    7DQp9DQphOmFjdGl2ZSB7DQogIGNvbG9yOiBibHVlIDsNCmZvbnQtZmFtaWx5OnRhaG9tYSxhcmlhbC
    x2ZXJkYW5hOw0KICAgYmFja2dyb3VuZC1jb2xvcjogdHJhbnNwYXJlbnQgOw0KZm9udC1zaXplOjEzc
    Hg7DQp9DQoNCjwvc3R5bGU+DQo8L2hlYWQ+DQo8Ym9keSBiZ2NvbG9yPSIjRkZGRkZGIj4NCjx0YWJs
    ZSBhbGlnbj0iY2VudGVyIiBpZD0iVGFibGVfMDEiIHdpZHRoPSI2NDAiIGJvcmRlcj0iMCIgY2VsbHB
    hZGRpbmc9IjAiIGNlbGxzcGFjaW5nPSIwIj4NCgk8dHI+DQoJCTx0ZCBjb2xzcGFuPSI1Ij4NCg0KCQ
    kJPGltZyBpZD0ibWFpbnRfc3BsYXNoXzAxIiBzcmM9ImltYWdlcy9tYWludC1zcGxhc2gtMDJfMDEuc
    G5nIiB3aWR0aD0iNjQwIiBoZWlnaHQ9IjMzMSIgYWx0PSIiIC8+PC90ZD4NCgk8L3RyPg0KCTx0cj4N
    CgkJPHRkIHJvd3NwYW49IjMiPg0KCQkJPGltZyBpZD0ibWFpbnRfc3BsYXNoXzAyIiBzcmM9ImltYWd
    lcy9tYWludC1zcGxhc2hfMDIucG5nIiB3aWR0aD0iMzQiIGhlaWdodD0iMTQ5IiBhbHQ9IiIgLz48L3
    RkPg0KCQk8dGQgY29sc3Bhbj0iMyIgd2lkdGg9IjU3NCIgaGVpZ2h0PSIxMDIiIHZhbGlnbj0idG9wI
    j4NCgkJCTxkaXY+QmxhY2tib2FyZCBpcyB0ZW1wb3JhcmlseSB1bmF2YWlsYWJsZS4gIFdlIGFyZSBh
    d2FyZSBvZiB0aGUgc2VydmljZSBpbnRlcnJ1cHRpb24gYW5kIHdlIGFwb2xvZ2l6ZSBmb3IgdGhlIGl
    uY29udmVuaWVuY2UuPGJyPjxicj4NCgkJCU91ciBzdGFmZiBpcyB3b3JraW5nIG9uIHRoZSBpc3N1ZS
    4gV2Ugd2lsbCBoYXZlIHRoZSBzaXRlIHVwIGFuZCBydW5uaW5nIGFnYWluIGFzIHNvb24gYXMgcG9zc
    2libGUuICBQbGVhc2UgdHJ5IGFnYWluIGF0IGEgbGF0ZXIgdGltZS48L2Rpdj4NCg0KPC90ZD4NCgkJ
    PHRkIHJvd3NwYW49IjMiPg0KCQkJPGltZyBpZD0ibWFpbnRfc3BsYXNoXzA0IiBzcmM9ImltYWdlcy9
    tYWludC1zcGxhc2hfMDQucG5nIiB3aWR0aD0iMzIiIGhlaWdodD0iMTQ5IiBhbHQ9IiIgLz48L3RkPg
    0KCTwvdHI+DQoJPHRyPg0KCQk8dGQgd2lkdGg9IjI4NyIgaGVpZ2h0PSIxNiIgdmFsaWduPSJ0b3AiP
    g0KCQkJPGRpdj48YSBocmVmPSJodHRwOi8va2IuYmxhY2tib2FyZC5jb20vZGlzcGxheS9JRFNSL1N0
    dWRlbnQrYW5kK0ZhY3VsdHkrU3VwcG9ydCtSZXNvdXJjZStDZW50ZXIiPlN0dWRlbnQgJiBJbnN0cnV
    jdG9yIFJlc291cmNlczwvYT48L2Rpdj4gICAgICAgICAgICA8L3RkPg0KCQk8dGQgcm93c3Bhbj0iMi
    I+DQoNCgkJCTxpbWcgaWQ9Im1haW50X3NwbGFzaF8wNiIgc3JjPSJpbWFnZXMvbWFpbnQtc3BsYXNoX
    zA2LnBuZyIgd2lkdGg9IjI3IiBoZWlnaHQ9IjQ3IiBhbHQ9IiIgLz48L3RkPg0KCQk8dGQgd2lkdGg9
    IjI2MCIgaGVpZ2h0PSIxNiIgdmFsaWduPSJ0b3AiIGFsaWduPSJyaWdodCI+DQoJCTxkaXY+PGEgaHJ
    lZj0iaHR0cDovL21hbmFnZWRob3N0aW5nLmJsYWNrYm9hcmQuY29tIj5CZWhpbmQgdGhlIEJsYWNrYm
    9hcmQgKGFkbWluaXN0cmF0b3JzIG9ubHkpPC9hPjwvZGl2Pgk8L3RkPg0KCTwvdHI+DQoJPHRyPg0KC
    Qk8dGQ+DQoJCQk8aW1nIGlkPSJtYWludF9zcGxhc2hfMDgiIHNyYz0iaW1hZ2VzL21haW50LXNwbGFz
    aF8wOC5wbmciIHdpZHRoPSIyODciIGhlaWdodD0iMzEiIGFsdD0iIiAvPjwvdGQ+DQoJCTx0ZD4NCg0
    KCQkJPGltZyBpZD0ibWFpbnRfc3BsYXNoXzA5IiBzcmM9ImltYWdlcy9tYWludC1zcGxhc2hfMDkucG
    5nIiB3aWR0aD0iMjYwIiBoZWlnaHQ9IjMxIiBhbHQ9IiIgLz48L3RkPg0KCTwvdHI+DQo8L3RhYmxlP
    g0KPGJyPg0KPC9ib2R5Pg0KPC9odG1sPg0K